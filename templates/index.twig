{% extends 'base.twig' %}

{% block title %}Inicio{% endblock %}

{% block content %}
<div class="container">
    <h1 class="text-center text-primary mb-5">Bienvenido a Libronia</h1>
    <div class="alert alert-success text-center" role="alert">
        ¡Explora nuestras categorías y descubre nuevas lecturas!
    </div>

    <!-- Formulario de búsqueda -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="card-title text-secondary">Buscar y explorar libros</h5>
                    <form action="/buscar" method="GET">
                        <div class="input-group">
                            <input type="text" name="q" class="form-control" placeholder="Escribe el nombre del libro o autor..." required>
                            <button class="btn btn-primary" type="submit">Buscar</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Sección de categorías -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="card-title text-secondary">Categorías</h5>
                    <div class="row">
                        {% for categoria in categorias %}
                        <div class="col-md-4 col-sm-6 col-12 mb-2">
                            <a href="/categoria/{{ categoria|url_encode }}" class="list-group-item list-group-item-action">
                                {{ categoria }}
                            </a>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="alert alert-info text-center mt-4" role="alert">
        ¡Sigue explorando y encuentra tu próxima lectura favorita!
    </div>

    <!-- Mapa -->
    <div class="card mt-4">
        <div class="card-body">
            <h5 class="card-title text-secondary">Bibliotecas cercanas a tu ubicación:</h5>
            <div class="map-container">
                <div id="map"></div>
            </div>
        </div>
    </div>
</div>

{% block scripts %}    
<script src="/assets/leaflet/leaflet.js"></script>
<script>
    var redIcon = new L.Icon({
        iconUrl: '/assets/leaflet/images/marker-icon-red.png',
        shadowUrl: '/assets/leaflet/images/marker-shadow.png',
        iconSize: [25, 41],
        iconAnchor: [12, 41],
        popupAnchor: [1, -34],
        shadowSize: [41, 41]
    });

    // Ubicación central
    var ILocation = [41.45551, 2.20150];
    var map = L.map('map').setView(ILocation, 16);

    // Cargamos la capa de OpenStreetMap
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {}).addTo(map);

    // Marcador para la ubicación actual
    L.marker(ILocation, { icon: redIcon }).addTo(map)
        .bindPopup('Estás Aquí')
        .openPopup();

    // Agregamos marcadores de "bibliotecas" (ubicaciones inventadas)
    L.marker([41.45700, 2.20300]).addTo(map)
        .bindPopup('Biblioteca del Saber');

    L.marker([41.45400, 2.20000]).addTo(map)
        .bindPopup('Centro de Lectura Aurora');

    L.marker([41.45600, 2.20600]).addTo(map)
        .bindPopup('Archivo de Letras');

    L.marker([41.45350, 2.20350]).addTo(map)
        .bindPopup('Sala del Conocimiento');
</script>
{% endblock %}

{% endblock %}
